(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(t,e,n){},14:function(t,e,n){},16:function(t,e,n){},22:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n.n(i),o=n(6),c=n.n(o),r=(n(13),n(14),n(1)),s=n(3);function h(t){return t?{width:t.offsetWidth,height:t.offsetHeight}:{width:0,height:0}}n(16);var u=function(t){var e=t.animator,n=Object(i.useRef)(null),o=function(t,e){var n=Object(i.useState)(h(t?t.current:{})),a=Object(r.a)(n,2),o=a[0],c=a[1],u=Object(i.useCallback)(function(){if(t.current&&(c(h(t.current)),e)){var n=!0,i=!1,a=void 0;try{for(var o,r=e[Symbol.iterator]();!(n=(o=r.next()).done);n=!0)(0,o.value)()}catch(s){i=!0,a=s}finally{try{n||null==r.return||r.return()}finally{if(i)throw a}}}},[t]),l=Object(s.debounce)(u,300);return Object(i.useLayoutEffect)(function(){if(t.current)return l(),window.addEventListener("resize",l),function(){window.removeEventListener("resize",l)}},[t.current]),o}(n,[e.onResize]),c=(function(t,e){var n=Object(i.useRef)(t);Object(i.useLayoutEffect)(function(){n.current=t},[t]);var a=Object(i.useRef)();Object(i.useLayoutEffect)(function(){var n=t.current;if(null!=n)return e.setCanvas(n),a.current=requestAnimationFrame(e.doFrame),n.addEventListener("touchstart",e.touchStart),n.addEventListener("touchmove",e.touchMove),n.addEventListener("touchend",e.touchEnd),n.addEventListener("click",e.mouseLeft),n.addEventListener("contextmenu",e.mouseRight),function(){cancelAnimationFrame(a.current),n.removeEventListener("touchstart",e.touchStart),n.removeEventListener("touchmove",e.touchMove),n.removeEventListener("touchend",e.touchEnd),n.removeEventListener("click",e.mouseLeft),n.removeEventListener("contextmenu",e.mouseRight)}},[])}(n,e),o.width),u=o.height;return a.a.createElement("div",{className:"Canvas"},c,a.a.createElement("canvas",{ref:n,height:u,width:c}))},l=n(4),v=n(7),d=["#C0C0C0","#FF0000","#800000","#FFFF00","#808000","#00FF00","#008000","#00FFFF","#008080","#0000FF","#000080","#FF00FF","#800080"],f=Object.freeze({color:"black",lineWidth:5,callback:function(){},callbackInterval:1});function g(t,e,n){var i=Object.assign({},f,n),a=i.lineWidth,o=i.color,c=i.callback,r=t.getContext("2d"),s=t.width-a,h=t.height-a,u=2*(s+h),l=a/2,v=e/i.callbackInterval,d=0,g=u/e,m=0;return{reset:function(){m=0,d=0},draw:function(t){(m+=t)>e&&(m=e),m>=(d+1)*v&&(console.log("invocation ".concat(d)),c(),d++),r.beginPath(),r.lineWidth=a,r.strokeStyle=o,r.moveTo(l,l);var n=g*m;return n<=s?(r.lineTo(n+l,l),void r.stroke()):(r.lineTo(s+l,l),(n-=s)<=h?(r.lineTo(s+l,n+l),void r.stroke()):(r.lineTo(s+l,h+l),(n-=h)<=s?(r.lineTo(s-n+l,h+l),void r.stroke()):(r.lineTo(l,h+l),(n-=s)<=h?(r.lineTo(l,h-n+l),void r.stroke()):(r.lineTo(l,l),void r.stroke()))))}}}var m,T=n(17)();!function(t){t[t.Normal=0]="Normal",t[t.Vanishing=1]="Vanishing"}(m||(m={}));var w={frames:45,vanishLength:2500,frameDelay:100};function y(t,e,n){var i=Object.assign({},w,n),a=m.Normal,o=t.draw,c=0,r=[],s={vanishOptions:i,getState:function(){return a},setState:function(e){if(a!=e)if((a=e)==m.Normal)c=0;else if(a==m.Vanishing&&(c=0,0==r.length)){t.imageData;r=function(t,e){for(var n=[],i=t.data,a=t.data.slice(0).fill(0),o=t.width,c=t.height,r=Array.from({length:e},function(t){return a.slice(0)}),s=0;s<i.length;s+=4){var h=Math.floor(s/i.length*e),u=r[b(h,e)];u[s]=i[s],u[s+1]=i[s+1],u[s+2]=i[s+2],u[s+3]=i[s+3],255==u[s]&&255==u[s+1]&&255==u[s+2]&&(u[s+3]=0)}for(var l=0;l<r.length;l++){var v=new Image,d=document.createElement("canvas");d.width=o,d.height=c;var f=d.getContext("2d");f.putImageData(new ImageData(r[l],o,c),0,0),v.src=d.toDataURL("image/png"),n.push(v)}return n}(t.imageData,i.frames)}},draw:function(e,n){if(a==m.Normal)o(e,n);else if(a==m.Vanishing){if((c+=n)>=r.length*i.frameDelay+i.vanishLength)return;for(var s=0;s<r.length;s++){var h=c-(s+1)*i.frameDelay,u=p(1-h/i.vanishLength,0,1);e.globalAlpha=u,e.drawImage(r[s],t.position.x,t.position.y)}e.globalAlpha=1}}};return Object.assign({},t,s)}var p=function(t,e,n){return t<e?e:t>n?n:t},b=function(t,e){for(var n=[],i=[],a=0;a<e;a++)n.push(Math.pow(e-Math.abs(t-a),e/2)),i.push(a);return T.weighted(i,n)};var F;!function(t){t[t.Empty=0]="Empty",t[t.Listening=1]="Listening",t[t.Selecting=2]="Selecting",t[t.Finished=3]="Finished"}(F||(F={}));var E=function t(){var e=this;Object(v.a)(this,t),this.touchStart=void 0,this.touchMove=void 0,this.touchEnd=void 0,this.mouseLeft=void 0,this.mouseRight=void 0,this.lastFrame=void 0,this.canvas=void 0,this.ctx=void 0,this.width=void 0,this.height=void 0,this.activeTouches=void 0,this.colors=void 0,this.offset=void 0,this.state=void 0,this.enableResetFlag=void 0,this.countDownToLock=void 0,this.countDownToSelect=void 0,this.selectedIndex=void 0,this.setCanvas=function(t){e.canvas=t,e.ctx=e.canvas.getContext("2d"),e.onResize()},this.onResize=function(){var t=e.canvas.getBoundingClientRect();e.offset={x:t.left,y:t.top};var n=e.canvas;e.width=n.width,e.height=n.height,e.countDownToLock=g(n,2e3,{color:"red",callback:e.lockPlayers,lineWidth:10})},this.lockPlayers=function(){e.countDownToSelect=g(e.canvas,4e3,{color:"yellow",callback:e.selectRandomPlayer,callbackInterval:e.activeTouches.length-1,lineWidth:10}),e.activeTouches=e.activeTouches.map(function(t){return y(t,e.ctx,void 0)}),e.state=F.Selecting},this.selectRandomPlayer=function(){var t=e.activeTouches.filter(function(t){return t.getState()===m.Normal}),n=t[Math.floor(Math.random()*t.length)].id,i=e.activeTouches.findIndex(function(t){return t.id==n});e.activeTouches[i].setState(m.Vanishing),2==t.length&&(e.state=F.Finished)},this.copyTouch=function(t){var n=t.identifier;return function(t,e,n,i){var a,o=n;return{get id(){return t},get imageData(){return a},get position(){return o},set position(t){o=t},get radius(){return i},set radius(t){i=t},get color(){return e},set color(t){e=t},draw:function(t,n){if(t.beginPath(),t.fillStyle=e,t.arc(o.x,o.y,i,0,2*Math.PI),t.fill(),void 0==a){var c=o.x-i,r=o.y-i;a=t.getImageData(c,r,2*i,2*i)}}}}(n,d[n],{x:t.pageX-e.offset.x,y:t.pageY-e.offset.y},60)},this.updateTouches=function(t){if(e.state==F.Empty||e.state==F.Listening){var n=Array.from(t.targetTouches);n.length!=e.activeTouches.length&&e.countDownToLock.reset(),e.activeTouches=n.map(function(t){return e.copyTouch(t)});var i=e.activeTouches.length;i<=1&&(e.state=F.Empty),i>1&&(e.state=F.Listening)}e.state==F.Finished&&(t.targetTouches.length>0&&e.enableResetFlag&&(e.state=F.Empty,e.enableResetFlag=!1),0==t.targetTouches.length&&(e.enableResetFlag=!0))},this.clickAsTouch=function(t){if(e.state==F.Empty||e.state==F.Listening){var n={identifier:e.activeTouches.length,pageX:t.clientX,pageY:t.clientY},i=e.copyTouch(n);e.activeTouches=[].concat(Object(l.a)(e.activeTouches),[i]),e.activeTouches.length>1&&e.state==F.Empty&&(e.state=F.Listening),e.countDownToLock.reset()}e.state==F.Finished&&(e.activeTouches=[],e.state=F.Empty)},this.clickToCancel=function(t){if(t.preventDefault(),0!=e.activeTouches.length&&e.state!=F.Selecting){if(e.state==F.Finished)return e.activeTouches=[],void(e.state=F.Empty);e.activeTouches=e.activeTouches.slice(0,-1),e.activeTouches.length<=1&&(e.state=F.Empty),e.countDownToLock.reset()}},this.doFrame=function(t){var n=t-e.lastFrame;if(e.lastFrame=t,window.requestAnimationFrame(e.doFrame),null!=e.ctx&&void 0!=e.ctx){var i=e.ctx;if(i.fillStyle="black",i.fillRect(0,0,e.width,e.height),e.state==F.Empty&&e.countDownToLock.reset(),e.state!=F.Finished){var a=!0,o=!1,c=void 0;try{for(var r,s=e.activeTouches[Symbol.iterator]();!(a=(r=s.next()).done);a=!0)r.value.draw(i,n)}catch(f){o=!0,c=f}finally{try{a||null==s.return||s.return()}finally{if(o)throw c}}}if(e.state==F.Listening&&e.countDownToLock.draw(n),e.state==F.Selecting&&e.countDownToSelect.draw(n),e.state==F.Finished){var h=!0,u=!1,l=void 0;try{for(var v,d=e.activeTouches[Symbol.iterator]();!(h=(v=d.next()).done);h=!0)v.value.draw(i,n)}catch(f){u=!0,l=f}finally{try{h||null==d.return||d.return()}finally{if(u)throw l}}}}},this.lastFrame=0,this.touchStart=this.updateTouches,this.touchMove=this.updateTouches,this.touchEnd=this.updateTouches,this.mouseLeft=this.clickAsTouch,this.mouseRight=this.clickToCancel,this.canvas=null,this.ctx=null,this.countDownToLock=null,this.selectedIndex=-1,this.activeTouches=[],this.colors=Object(l.a)(d),this.offset={x:0,y:0},this.height=this.width=0,this.state=F.Empty,this.enableResetFlag=!1},L=function(){return a.a.createElement("div",{className:"App"},a.a.createElement("p",null,"Testing"),a.a.createElement(u,{height:400,width:600,animator:new E}))};c.a.render(a.a.createElement(L,null),document.getElementById("root"))},8:function(t,e,n){t.exports=n(22)}},[[8,1,2]]]);
//# sourceMappingURL=main.8cd8ae1b.chunk.js.map